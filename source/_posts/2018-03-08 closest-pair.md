---
title: 最近點對
date: 2018-03-08 00:23:35
categories: 懶人筆記
tags:
    - 演算法
    - 分治法
    - 計算幾何
    - UVa
description: UVa 10245 - The Closest Pair Problem
---

## 廢話時間

實驗室的同學修演算法，最近幾天在討論如何用分治法解決平面上最近點對問題。
手癢找了 [UVa 10245](https://uva.onlinejudge.org/external/102/10245.pdf) 這題來練習一下。
很久沒碰演算法競賽的題目了，果然一寫就寫出了極度智障的Bug，WA了7次才發現自己有多腦殘，久違的AC不禁讓我感慨萬千。

## 問題描述

坐標平面上給定 N (0≤N≤10000) 個點，求出最近點對的距離。
如果不存在點對使得其距離在 10000 以內，則輸出 "INFINITY"，否則輸出最近點對的距離至小數點以下4位。

## 嘴砲解題

這題有滿多種解法的。以下主要探討的是分治法。
分治法的想法很簡單，把問題切小(通常是切一半)，處理完子問題之後再想辦法合併。
分治法的演算法架構都大同小異，解決這個問題的步驟可以用函式F來描述。
按照上面的想法，函式F的步驟就會是：
1. 把平面上面的點分兩堆A, B，點數儘可能一樣多。
2. 在A, B兩堆求解子問題。怎麼解？就是用函式F。
3. 利用A, B兩堆的答案，嘗試求出整體的答案。

### Step1. 分堆

用說得很簡單，可是具體而言要怎麼把平面上的點劃分成兩堆？
憑直覺應該會想要像切蛋糕一樣從中間剖半對吧。
不過要怎麼從中間剖半，到底哪裡是中間？該怎麼定義比較好？
會不會有沒辦法剖半的情況？遇到這種情況要怎麼辦？

### Step2. 遞迴

總之就是不負責任地遞迴呼叫函式本身去處理更小的問題，非常歡樂。
遞迴會不會停不下來？遞迴的邊界條件是？

### Step3. 整合

前一個步驟已經求出了什麼？A和B各自的最近點對的距離。
知道這些就已經足夠得出最後的答案嗎？我們還需要什麼資訊？
不難發現，最近點對只有三種情況：
- 兩點皆落在A (Step2 已解決)
- 兩點皆落在B (Step2 已解決)
- 一點在A，另一點在B (剩這個情況要處理)

## 後記

詳細的演算法網路上隨便找都有，重要的是思考的過程。
上面的問題都想通之後，自然就知道怎麼做了。
值得注意的是網路上很多寫法在合併過程 (Step3) 的時間複雜度並不是O(N)，請不要隨便複製貼上。
